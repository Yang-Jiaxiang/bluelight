function scroll(){"scroll"==BL_mode&&(DeleteMouseEvent(),Mousedown=function(e){switch(e.which){case 1:MouseDownCheck=!0;break;case 2:default:break;case 3:rightMouseDown=!0}windowMouseX=GetmouseX(e),windowMouseY=GetmouseY(e),GetViewport().originalPointX=getCurrPoint(e)[0],GetViewport().originalPointY=getCurrPoint(e)[1]},Mousemove=function(e){var t=getCurrPoint(e)[0],o=getCurrPoint(e)[1],i=getClass("labelXY");{let t=rotateCalculation(e);i[viewportNumber].innerText="X: "+parseInt(t[0])+" Y: "+parseInt(t[1])}if(1==rightMouseDown&&scale_size(e,t,o),1==openLink)for(var r=0;r<Viewport_Total;r++)GetViewport(r).newMousePointX=GetViewport().newMousePointX,GetViewport(r).newMousePointY=GetViewport().newMousePointY;for(putLabel(),r=0;r<Viewport_Total;r++)displayRuler(r);if(MouseDownCheck){windowMouseX=GetmouseX(e),windowMouseY=GetmouseY(e);var n=GetViewport().sop;let i=SearchUid2Index(n),r=i[0],s=i[1],g=i[2];var a=parseInt(Patient.Study[r].Series[s].Sop[g].InstanceNumber),l=sortInstance(n);if(l.length<=1){if(1==l.length&&l[0].frames){null==GetViewport().framesNumber&&(GetViewport().framesNumber=0),w=0;var u=GetViewport().framesNumber;for(w=0;w<l[0].frames.length&&w!=u;w++);Math.abs(o-GetViewport().originalPointY)<Math.abs(t-GetViewport().originalPointX)?t<GetViewport().originalPointX-3?(nextFrame(viewportNumber,-1),w-1<0&&l[0].frames.length):t>GetViewport().originalPointX+3&&(nextFrame(viewportNumber,1),u==w&&l[0].frames.length):o<GetViewport().originalPointY-3?(nextFrame(viewportNumber,-1),w-1<0&&l[0].frames.length):o>GetViewport().originalPointY+3&&(nextFrame(viewportNumber,1),l[0].frames.length)}}else{var w=0;for(w=0;w<l.length&&l[w].InstanceNumber!=a;w++);Math.abs(o-GetViewport().originalPointY)<Math.abs(t-GetViewport().originalPointX)?t<GetViewport().originalPointX-3?(nextFrame(viewportNumber,-1),w-1<0&&l.length):t>GetViewport().originalPointX+3&&(nextFrame(viewportNumber,1),l[w].InstanceNumber==a&&l.length):o<GetViewport().originalPointY-3?(nextFrame(viewportNumber,-1),w-1<0&&l.length):o>GetViewport().originalPointY+3&&(nextFrame(viewportNumber,1),l.length)}GetViewport().originalPointX=t,GetViewport().originalPointY=o}},Mouseup=function(e){if(getCurrPoint(e)[0],getCurrPoint(e)[1],1==openMouseTool&&1==rightMouseDown&&displayMark(),MouseDownCheck=!1,rightMouseDown=!1,magnifierDiv.style.display="none",openLink)for(var t=0;t<Viewport_Total;t++)displayRuler(t)},Touchstart=function(e,t){t?rightTouchDown=!0:TouchDownCheck=!0,windowMouseX=GetmouseX(e),windowMouseY=GetmouseY(e),1==rightTouchDown&&t&&(windowMouseX2=GetmouseX(t),windowMouseY2=GetmouseY(t)),GetViewport().originalPointX=getCurrPoint(e)[0],GetViewport().originalPointY=getCurrPoint(e)[1],1==rightTouchDown&&t&&(GetViewport().originalPointX2=getCurrPoint(t)[0],GetViewport().originalPointY2=getCurrPoint(t)[1])},Touchmove=function(e,t){if(!openDisplayMarkup||!getByid("DICOMTagsSelect").selected&&!getByid("AIMSelect").selected){var o=getCurrPoint(e)[0],i=getCurrPoint(e)[1];if(t&&(getCurrPoint(t)[0],getCurrPoint(t)[1]),getClass("labelXY")[viewportNumber].innerText="X: "+Math.floor(o)+" Y: "+Math.floor(i),1==TouchDownCheck&&0==rightTouchDown){var r=GetViewport().sop;let e=SearchUid2Index(r),t=e[0],u=e[1],w=e[2];var n=parseInt(Patient.Study[t].Series[u].Sop[w].InstanceNumber),a=sortInstance(r);for(l=0;l<a.length&&a[l].InstanceNumber!=n;l++);Math.abs(i-GetViewport().originalPointY)<Math.abs(o-GetViewport().originalPointX)?o<GetViewport().originalPointX-3?(nextFrame(viewportNumber,-1),l-1<0?a.length:l):o>GetViewport().originalPointX+3&&(nextFrame(viewportNumber,1),a[l].InstanceNumber==n&&(l+1>=a.length||l)):i<GetViewport().originalPointY-3?(nextFrame(viewportNumber,-1),l-1<0?a.length:l):i>GetViewport().originalPointY+3&&(nextFrame(viewportNumber,1),l+1>=a.length||l),GetViewport().originalPointX=o,GetViewport().originalPointY=i}}},Touchend=function(e,t){1==TouchDownCheck&&(1==openAngle?openAngle=2:2==openAngle&&(openAngle=3)),TouchDownCheck=!1,rightTouchDown=!1,magnifierDiv.style.display="none"},AddMouseEvent())}